<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Listado de Personas - Paginación</title>
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
    <div class="container my-5">
    <h1 class="mb-4">Personas Inscriptas</h1>

    <div id="personas" class="list-group mb-4"></div>

    <nav aria-label="Paginación">
        <ul class="pagination justify-content-center">
        <li class="page-item" id="btnAnterior">
            <button class="page-link">Anterior</button>
        </li>
        <li class="page-item disabled" id="paginaActual">
            <span class="page-link">Página 1</span>
        </li>
        <li class="page-item" id="btnSiguiente">
            <button class="page-link">Siguiente</button>
            </li>
        </ul>
    </nav>
    </div>

<!-- Bootstrap JS Bundle (incluye Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    let pagina = 1;
    const limite = 5;

    const btnAnterior = document.getElementById('btnAnterior');
    const btnSiguiente = document.getElementById('btnSiguiente');
    const paginaActual = document.getElementById('paginaActual');
    const contenedor = document.getElementById('personas');

    function cargarPagina() {
        fetch(`/administrar?pagina=${pagina}&limite=${limite}`)
        .then(response => response.json())
        .then(data => {
            contenedor.innerHTML = '';

        if (data.personas.length === 0) {
            contenedor.innerHTML = `<div class="alert alert-info">No hay más resultados.</div>`;
            btnSiguiente.classList.add('disabled');
            return;
        }

        data.personas.forEach(p => {
            const item = document.createElement('div');
            item.classList.add('list-group-item');
            item.innerHTML = `<strong>${p.nombre} ${p.apellido}</strong> - DNI: ${p.dni} <br> Curso: ${p.curso}`;
            contenedor.appendChild(item);
        });

          // Actualizar número de página
        paginaActual.querySelector('span').textContent = `Página ${pagina}`;

          // Habilitar o deshabilitar botones según página
        btnAnterior.classList.toggle('disabled', pagina === 1);
          btnSiguiente.classList.remove('disabled'); // no sabemos total, lo habilitamos siempre aquí
        })
        .catch(error => {
        contenedor.innerHTML = `<div class="alert alert-danger">Error cargando datos.</div>`;
        console.error('Error:', error);
        });
    }

    btnAnterior.addEventListener('click', () => {
    if (pagina > 1) {
        pagina--;
        cargarPagina();
      }
    });

    btnSiguiente.addEventListener('click', () => {
    pagina++;
    cargarPagina();
    });

    // Cargar primera página al inicio
    cargarPagina();
</script>
</body>
</html>
